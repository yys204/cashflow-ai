version: '3.8'

services:
  # ä½ çš„ CashFlow AI åº”ç”¨
  app:
    container_name: cashflow-app
    build: .
    restart: always
    ports:
      - "3000:3000" # æŠŠå®¹å™¨çš„3000ç«¯å£æ˜ å°„åˆ°æœåŠ¡å™¨çš„3000
    environment:
      # ğŸš¨ æ³¨æ„ï¼šè¿™é‡Œçš„ä¸»æœºåæ˜¯ 'db'ï¼Œå¯¹åº”ä¸‹é¢çš„æœåŠ¡å
      DATABASE_URL: "postgresql://postgres:mysecretpassword@db:5432/cashflow?schema=public"
      # è®°å¾—å¡«ä½ çš„ DeepSeek Key
      DEEPSEEK_API_KEY: "sk-876e7de89b754894a559ad7087652efd"
      DEEPSEEK_BASE_URL: "https://api.deepseek.com/v1"
    depends_on:
      - db

  # å…è´¹çš„æ•°æ®åº“ (PostgreSQL)
  db:
    container_name: cashflow-db
    image: postgres:15-alpine
    restart: always
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: mysecretpassword # è‡ªå·±æ”¹ä¸ªå¤æ‚çš„å¯†ç 
      POSTGRES_DB: cashflow
    volumes:
      - postgres_data:/var/lib/postgresql/data # æ•°æ®æŒä¹…åŒ–ï¼Œé‡å¯ä¸ä¸¢å¤±

volumes:
  postgres_data: